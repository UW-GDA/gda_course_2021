#! /usr/bin/env python

import cdsapi

c = cdsapi.Client()

#Western U.S.  
#'area':[50, -127, 30, -102], # North, West, South, East. Default: global
#WA state
#area = [49,-124.75,45.5,-117]
area = [48.75,-124.5,45.75,-117.25]

variables = ['2m_temperature','total_precipitation','snow_depth']
#variables = ['2m_temperature','total_precipitation']
#variables = '2m_temperature'
#variables = 'total_precipitation'

#years = '2018'
years = ['1979','1980','1981','1982','1983','1984','1985','1986','1987','1988','1989','1990','1991','1992','1993','1994','1995','1996','1997','1998','1999','2000','2001','2002','2003','2004','2005','2006','2007','2008','2009','2010','2011','2012','2013','2014','2015','2016','2017','2018','2019','2020','2021']

#months = '12'
months = ['01','02','03','04','05','06','07','08','09','10','11','12']

days = ['01','02','03','04','05','06','07','08','09','10','11','12','13','14','15','16','17','18','19','20','21','22','23','24','25','26','27','28','29','30','31']

#times = '12:00'
times = ['00:00','06:00','12:00','18:00']
#times = ['00:00','03:00','06:00','09:00','12:00','15:00','18:00','21:00']
#times = ['00:00','01:00','02:00','03:00','04:00','05:00','06:00','07:00','08:00','09:00','10:00','11:00','12:00','13:00','14:00','15:00','16:00','17:00','18:00','19:00','20:00','21:00','22:00','23:00']

for v in variables:
    out_fn = f'era5_WA_1979-2021_6hr_{v}.grib'

    c.retrieve(
        'reanalysis-era5-single-levels',
        {
            'product_type':'reanalysis',
            'format':'grib',
            'variable':v,
            'area':area,
            'year':years,
            'month':months,
            'day':days,
            'time':times, 
        },
        out_fn)
